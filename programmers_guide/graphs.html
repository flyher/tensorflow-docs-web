<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>流图与会话</title>
    <link href="//tensorflow.juejin.im/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="//tensorflow.juejin.im/assets/css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="//tensorflow.juejin.im/assets/css/highlight.js.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
</head>
<body>
<!-- Header start -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="//tensorflow.juejin.im">TensorFlow</a>
    <button class="navbar-toggler" type="button" aria-expanded="false" aria-label="Menu"
            onclick="$('.collapse').toggle()">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse">
        <ul class="navbar-nav mr-auto">
        </ul>
        <form class="form-inline my-2 my-lg-0 my-md-0">
            <input class="form-control mr-sm-2" id="search" type="search" placeholder="Search" aria-label="Search">
        </form>
    </div>
</nav>
<script>
    var head = [{'link': '//tensorflow.juejin.im/extend/index.html', 'name': '扩展', 'selected': 0}, {'link': '//tensorflow.juejin.im/install/index.html', 'name': '安装 TensorFlow', 'selected': 0}, {'link': '//tensorflow.juejin.im/deploy/index.html', 'name': '部署', 'selected': 0}, {'link': '//tensorflow.juejin.im/about/index.html', 'name': '关于 TensorFlow', 'selected': 0}, {'link': '//tensorflow.juejin.im/get_started/index.html', 'name': '开始', 'selected': 0}, {'link': '//tensorflow.juejin.im/mobile/index.html', 'name': '概述', 'selected': 0}, {'link': '//tensorflow.juejin.im/tutorials/index.html', 'name': '教程', 'selected': 0}, {'link': '//tensorflow.juejin.im/javascript/index.html', 'name': 'JavaScript', 'selected': 0}, {'link': '//tensorflow.juejin.im/performance/index.html', 'name': '性能', 'selected': 0}, {'link': '//tensorflow.juejin.im/community/index.html', 'name': '社区', 'selected': 0}, {'link': '//tensorflow.juejin.im/programmers_guide/index.html', 'name': '开发者指南', 'selected': 1}]
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92630037-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92630037-8');
</script>

<!-- Header end -->

<!-- Content start-->
<div class="container-fluid">
    <div class="row">
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
    <div class="sidebar-sticky" id="left-nav">

    </div>
</nav>
<script>
    var nav = [{'type': 'child', 'link': '//tensorflow.juejin.im/programmers_guide/index.html', 'title': '开发者指南'}, {'type': 'parent', 'title': ' High Level APIs', 'sub_class': [{'link': '//tensorflow.juejin.im/programmers_guide/eager.html', 'title': 'Eager Execution'}, {'link': '//tensorflow.juejin.im/programmers_guide/datasets.html', 'title': '数据导入'}, {'link': '//tensorflow.juejin.im/programmers_guide/estimators.html', 'title': '评估器'}]}, {'type': 'parent', 'title': ' Low Level APIs', 'sub_class': [{'link': '//tensorflow.juejin.im/programmers_guide/low_level_intro.html', 'title': '底层 API 编程介绍'}, {'link': '//tensorflow.juejin.im/programmers_guide/tensors.html', 'title': '张量'}, {'link': '//tensorflow.juejin.im/programmers_guide/variables.html', 'title': '变量'}, {'link': '//tensorflow.juejin.im/programmers_guide/graphs.html', 'title': '流图与会话'}, {'link': '//tensorflow.juejin.im/programmers_guide/saved_model.html', 'title': '保存和恢复'}]}, {'type': 'parent', 'title': ' Accelerators', 'sub_class': [{'link': '//tensorflow.juejin.im/programmers_guide/using_gpu.html', 'title': '使用（多个）GPU'}, {'link': '//tensorflow.juejin.im/programmers_guide/using_tpu.html', 'title': '使用 TPU'}]}, {'type': 'parent', 'title': ' ML Concepts', 'sub_class': [{'link': '//tensorflow.juejin.im/programmers_guide/embedding.html', 'title': 'Embeddings'}]}, {'type': 'parent', 'title': ' Debugging', 'sub_class': [{'link': '//tensorflow.juejin.im/programmers_guide/debugger.html', 'title': 'TensorFlow 调试器'}]}, {'type': 'parent', 'title': ' TensorBoard', 'sub_class': [{'link': '//tensorflow.juejin.im/programmers_guide/summaries_and_tensorboard.html', 'title': 'Tensorboard：可视化学习面板'}, {'link': '//tensorflow.juejin.im/programmers_guide/graph_viz.html', 'title': 'TensorBoard: 图形可视化'}, {'link': '//tensorflow.juejin.im/programmers_guide/tensorboard_histograms.html', 'title': 'TensorBoard 直方图面板'}]}, {'type': 'parent', 'title': ' Misc', 'sub_class': [{'link': '//tensorflow.juejin.im/programmers_guide/version_compat.html', 'title': 'TensorFlow 版本兼容性'}, {'link': '//tensorflow.juejin.im/programmers_guide/faq.html', 'title': '常见问题'}]}]
</script>
        <main role="main" class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content">
            <h1 id="toc-0">流图与会话</h1>
<p>TensorFlow 使用<strong>数据流图</strong>（Dataflow graph，后文以“流图”简称。）表示计算过程，它是依据各个操作之间的依赖关系生成的。这是一个底层的编程模型，你需要先定义数据流图，然后创建一个 TensorFlow <strong>会话</strong>以在多个本地或远程的设备上运行流图的各个部分。</p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/estimator/Estimator"><code>tf.estimator.Estimator</code></a></p>
<h2 id="toc-1">为什么要用数据流图？</h2>
<p><img src="../images/tensors_flowing.gif" alt=""></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/matmul"><code>tf.matmul</code></a></p>
<!-- TODO(barryr): Add a diagram to illustrate the @{tf.matmul} graph. -->

<p>TensorFlow 利用数据流模型来执行程序，有如下几个优点：</p>
<ul>
<li><p><strong>并行编程</strong> 使用显式边来表示操作间的依赖关系，系统就能很容易的识别出可以并行的操作。</p>
</li>
<li><p><strong>分布执行</strong>  用显式边来表示操作间传递的值，TensorFlow 可以将你的程序分布到不同机器的不同设备（CPU, GPU 和 TPU）上，并完成必要的设备间通信和协调工作。</p>
</li>
<li><p><a href="//tensorflow.juejin.im/performance/xla/index.html">XLA 概述</a></p>
</li>
<li><p><a href="//tensorflow.juejin.im/programmers_guide/saved_model.html">保存和恢复</a></p>
</li>
</ul>
<h2 id="toc-2"><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
<ul>
<li><p><strong>流图结构</strong> 图的节点和边表明了各个独立操作组合在一起的方式，但并没有说明他们的用法。流图结构很像汇编代码：查看代码能够得到一些有用的信息，但它并不能传达给你所有源代码中的有效信息。</p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/train/Optimizer"><code>tf.train.Optimizer</code></a></p>
</li>
</ul>
<h2 id="toc-3"><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
<ul>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/Operation"><code>tf.Operation</code></a></p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/Tensor"><code>tf.Tensor</code></a></p>
</li>
<li><p><a href="//tensorflow.juejin.im/programmers_guide/variables.html">变量</a></p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/Operation"><code>tf.Operation</code></a></p>
</li>
</ul>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/estimator/Estimator"><code>tf.estimator.Estimator</code></a></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Session"><code>tf.Session</code></a></p>
<h2 id="toc-4">操作的命名</h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Operation"><code>tf.Operation</code></a></p>
<ul>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/Tensor"><code>tf.Tensor</code></a></p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/name_scope"><code>tf.name_scope</code></a></p>
<pre><code class="lang-python">c_0 = tf.constant(0, name=&quot;c&quot;)  # =&gt; operation named &quot;c&quot;

 # 已经被使用过的名称将会变为 &quot;uniquified&quot;。
 c_1 = tf.constant(2, name=&quot;c&quot;)  # =&gt; operation named &quot;c_1&quot;

 # 命名空间为在同一上下文环境中创建的所有操作添加一个前缀。
 with tf.name_scope(&quot;outer&quot;):
   c_2 = tf.constant(2, name=&quot;c&quot;)  # =&gt; 操作被命名为&quot;outer/c&quot;

   # 命名空间像分层文件系统中嵌套的路径。
   with tf.name_scope(&quot;inner&quot;):
     c_3 = tf.constant(3, name=&quot;c&quot;)  # =&gt; 操作被命名为 &quot;outer/inner/c&quot;

   # 退出命名空间,将返回到前一个前缀名称所表示的命名空间。
   c_4 = tf.constant(4, name=&quot;c&quot;)  # =&gt; 操作被命名为 &quot;outer/c_1&quot;

 # 已经被使用过的名称将会变为 &quot;uniquified&quot;。
 with tf.name_scope(&quot;inner&quot;):
     c_5 = tf.constant(5, name=&quot;c&quot;)  # =&gt; 操作被命名为 &quot;outer/inner_1/c&quot;
</code></pre>
</li>
</ul>
<p>图形可视化工具使用命名空间来将操作分组，并减少图形的视觉复杂性。请参阅<a href="#将流图可视化">将流图可视化</a>来获取更多信息。</p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Operation"><code>tf.Operation</code></a></p>
<ul>
<li><code>"&lt;OP_NAME&gt;"</code> 是生成 tensor 的操作名称。</li>
<li><code>"&lt;i&gt;"</code> 是一个整数，表示操作的输出中 tensor 的索引。</li>
</ul>
<h2 id="toc-5">在不同设备部署操作</h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/device"><code>tf.device</code></a></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/device"><code>tf.device</code></a></p>
<pre><code>/job:&lt;JOB_NAME&gt;/task:&lt;TASK_INDEX&gt;/device:&lt;DEVICE_TYPE&gt;:&lt;DEVICE_INDEX&gt;
</code></pre>
<p>分别表示：</p>
<ul>
<li><code>&lt;JOB_NAME&gt;</code> 是一个可以包含字母与数字的字符串，但不能以数字开头。</li>
<li><code>&lt;DEVICE_TYPE&gt;</code> 是一个已注册的设备类型（例如 <code>GPU</code> 或者 <code>CPU</code>）。</li>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/train/ClusterSpec"><code>tf.train.ClusterSpec</code></a></li>
<li><code>&lt;DEVICE_INDEX&gt;</code> 是一个非负整数，表示设备的索引，例如，用来区分在同一进程中使用的不同 GPU 设备。</li>
</ul>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/device"><code>tf.device</code></a></p>
<pre><code class="lang-python"># 创建时没有指定任何设备的操作将在“尽可能最好”的设备上运行。
# 例如，如果你有一个 GPU 和一个 CPU 可用，并且该操作具有 GPU
# 实现，则 TensorFlow 将选择该 GPU。
weights = tf.random_normal(...)

with tf.device(&quot;/device:CPU:0&quot;):
  #  此上下文中创建的操作会被分配到 CPU 上。
  img = tf.decode_jpeg(tf.read_file(&quot;img.jpg&quot;))

with tf.device(&quot;/device:GPU:0&quot;):
  # 当前上下文环境中创建的操作会被分配到 GPU 上。
  result = tf.matmul(weights, img)
</code></pre>
<p><a href="//tensorflow.juejin.im/deploy/distributed.html">分布式 TensorFlow</a></p>
<pre><code class="lang-python">with tf.device(&quot;/job:ps/task:0&quot;):
  weights_1 = tf.Variable(tf.truncated_normal([784, 100]))
  biases_1 = tf.Variable(tf.zeroes([100]))

with tf.device(&quot;/job:ps/task:1&quot;):
  weights_2 = tf.Variable(tf.truncated_normal([100, 10]))
  biases_2 = tf.Variable(tf.zeroes([10]))

with tf.device(&quot;/job:worker&quot;):
  layer_1 = tf.matmul(train_batch, weights_1) + biases_1
  layer_2 = tf.matmul(train_batch, weights_2) + biases_2
</code></pre>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Variable"><code>tf.Variable</code></a></p>
<pre><code class="lang-python">with tf.device(tf.train.replica_device_setter(ps_tasks=3)):
  # tf.Variable  默认情况下以轮询调度的方式部署在 &quot;/job:ps&quot; 的任务列表中
  w_0 = tf.Variable(...)  # placed on &quot;/job:ps/task:0&quot;
  b_0 = tf.Variable(...)  # placed on &quot;/job:ps/task:1&quot;
  w_1 = tf.Variable(...)  # placed on &quot;/job:ps/task:2&quot;
  b_1 = tf.Variable(...)  # placed on &quot;/job:ps/task:0&quot;

  input_data = tf.placeholder(tf.float32)     # 部署 &quot;/job:worker&quot;
  layer_0 = tf.matmul(input_data, w_0) + b_0  # 部署 &quot;/job:worker&quot;
  layer_1 = tf.matmul(layer_0, w_1) + b_1     # 部署 &quot;/job:worker&quot;
</code></pre>
<h2 id="toc-6">可用作 Tensor 的对象</h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Tensor"><code>tf.Tensor</code></a></p>
<ul>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/Tensor"><code>tf.Tensor</code></a></li>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/Variable"><code>tf.Variable</code></a></li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html"><code>numpy.ndarray</code></a></li>
<li><code>list</code> (和可用做 tensor 对象的列表)</li>
<li>Python 标量类型: <code>bool</code>, <code>float</code>, <code>int</code>, <code>str</code></li>
</ul>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/register_tensor_conversion_function"><code>tf.register_tensor_conversion_function</code></a></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Tensor"><code>tf.Tensor</code></a></p>
<h2 id="toc-7"><a href="https://www.tensorflow.org/api_docs/python/tf/Session"><code>tf.Session</code></a></h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
<h3 id="toc-8"><a href="https://www.tensorflow.org/api_docs/python/tf/Session"><code>tf.Session</code></a></h3>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Session"><code>tf.Session</code></a></p>
<pre><code class="lang-python"># 创建一个默认的进程内的会话。
with tf.Session() as sess:
  # ...

# 创建一个远程会话。
with tf.Session(&quot;grpc://example.org:2222&quot;):
  # ...
</code></pre>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Session/close"><code>tf.Session.close</code></a></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/estimator/RunConfig"><code>tf.estimator.RunConfig</code></a></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Session/__init__"><code>tf.Session.__init__</code></a></p>
<ul>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/train/Server"><code>tf.train.Server</code></a></p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/ConfigProto"><code>tf.ConfigProto</code></a></p>
<ul>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/device"><code>tf.device</code></a></p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/train/ClusterSpec/as_cluster_def"><code>tf.train.ClusterSpec.as_cluster_def</code></a></p>
</li>
<li><p><code>graph_options.optimizer_options</code> 提供对 TensorFlow 在执行流图前对其优化的控制。</p>
</li>
<li><p><code>gpu_options.allow_growth</code> 将其设置为 <code>True</code> 来更改 GPU 内存分配器，以便逐渐增加分配的内存量，而不是在启动时分配大部分内存。</p>
</li>
</ul>
</li>
</ul>
<h3 id="toc-9"><a href="https://www.tensorflow.org/api_docs/python/tf/Session/run"><code>tf.Session.run</code></a></h3>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Session/run"><code>tf.Session.run</code></a></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Session/run"><code>tf.Session.run</code></a></p>
<pre><code class="lang-python">x = tf.constant([[37.0, -23.0], [1.0, 4.0]])
w = tf.Variable(tf.random_uniform([2, 2]))
y = tf.matmul(x, w)
output = tf.nn.softmax(y)
init_op = w.initializer

with tf.Session() as sess:
  # 运行 `w` 的初始化操作。
  sess.run(init_op)

  # 对 `output` 求值。`sess.run(output)` 将返回一个包含计算结果的 NumPy 数组。
  print(sess.run(output))

  # 对 `y` 和 `output` 求值。请注意， `y` 只会计算一次，计算结果既作为 `y_val` 的值返回，
  # 又会作为 `tf.nn.softmax()` 操作的输入。`y_val` 和 `output_val` 都是 NumPy 数组。
  y_val, output_val = sess.run([y, output])
</code></pre>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/placeholder"><code>tf.placeholder</code></a></p>
<pre><code class="lang-python"># 定义一个三个浮点值向量的占位符和一个依赖于它的计算。
x = tf.placeholder(tf.float32, shape=[3])
y = tf.square(x)

with tf.Session() as sess:
  # 提供不同的参数值会求得不同的 `y` 值。
  print(sess.run(y, {x: [1.0, 2.0, 3.0]}))  # =&gt; &quot;[1.0, 4.0, 9.0]&quot;
  print(sess.run(y, {x: [0.0, 0.0, 5.0]}))  # =&gt; &quot;[0.0, 0.0, 25.0]&quot;

  # 抛出 `tf.errors.InvalidArgumentError`，因为你必须先给 `tf.placeholder()` 赋值，然后才能计算器依赖关系之上的 tensor 。
  sess.run(y)

  # 抛出 `ValueError`，因为 `37.0` 与 `x` 形状不匹配。
  sess.run(y, {x: 37.0})
</code></pre>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Session/run"><code>tf.Session.run</code></a></p>
<pre><code>y = tf.matmul([[37.0, -23.0], [1.0, 4.0]], tf.random_uniform([2, 2]))

with tf.Session() as sess:
  # 定义调用 `sess.run()` 的选项。
  options = tf.RunOptions()
  options.output_partition_graphs = True
  options.trace_level = tf.RunOptions.FULL_TRACE

  # 定义一个用于接受返回元数据的容器。
  metadata = tf.RunMetadata()

  sess.run(y, options=options, run_metadata=metadata)

  # 打印出在每个设备上执行的子流图。
  print(metadata.partition_graphs)

  # 打印出每次执行操作的执行时间。
  print(metadata.step_stats)
</code></pre>
<h2 id="toc-10">将流图可视化</h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
<pre><code class="lang-python"># 构建你的流图
x = tf.constant([[37.0, -23.0], [1.0, 4.0]])
w = tf.Variable(tf.random_uniform([2, 2]))
y = tf.matmul(x, w)
# ...
loss = ...
train_op = tf.train.AdagradOptimizer(0.01).minimize(loss)

with tf.Session() as sess:
  # `sess.graph` 提供了对 `tf.Session` 中流图的访问。
  writer = tf.summary.FileWriter(&quot;/tmp/log/...&quot;, sess.graph)

  # 执行你的计算...
  for i in range(1000):
    sess.run(train_op)
    # ...

  writer.close()
</code></pre>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/estimator/Estimator"><code>tf.estimator.Estimator</code></a></p>
<p>然后，你可以在 <code>tensorboard</code> 中打开日志，在 “Graph” 页面查看高度可视化的计算图结构。请注意， 一个典型的 TensorFlow 计算图——尤其是自动计算梯度的训练计算图——会由于节点太多而不能立刻全部可视化。计算图使用命名空间来将相关操作归纳到父节点。你可以点解父节点的橙色 "+" 按钮来展开其内部的子图。</p>
<p><img src="../images/mnist_deep.png" alt=""></p>
<p>要了解更多关于如何使用 TensorBoard 来可视化你的 TensorFlow 应用，请参阅 <a href="../get_started/summaries_and_tensorboard.md">TensorBoard 指南</a>。</p>
<h2 id="toc-11">使用多个流图编程</h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Operation"><code>tf.Operation</code></a></p>
<p>如上所述， TensorFlow 提供了一个“默认流图”，隐式传递给同一上下文中的所有 API 函数。对于许多个应用程序来说，一张流图就足够了。但是，TensorFlow 也提供了操作默认流图的方法，这在更高级的用例中是有用处的。例如：</p>
<ul>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/Operation"><code>tf.Operation</code></a></p>
</li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
</li>
</ul>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
<pre><code class="lang-python">g_1 = tf.Graph()
with g_1.as_default():
  # 这作用域中创建的操作会加到  `g_1` 中。
  c = tf.constant(&quot;Node in g_1&quot;)

  # 这个作用域中创建的会话会运行 `g_1` 中的操作。
  sess_1 = tf.Session()

g_2 = tf.Graph()
with g_2.as_default():
  # 这作用域中创建的操作会加到  `g_2` 中。
  d = tf.constant(&quot;Node in g_2&quot;)

# 或者，你可以在构建 `tf.Session` 时传递一个流图：
# `sess_2`会运行 `g_2` 中的操作。
sess_2 = tf.Session(graph=g_2)

assert c.graph is g_1
assert sess_1.graph is g_1

assert d.graph is g_2
assert sess_2.graph is g_2
</code></pre>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></p>
<pre><code class="lang-python"># 打印默认流图中所有的操作。
g = tf.get_default_graph()
print(g.get_operations())
</code></pre>

        </main>
        <div class="d-none d-xl-block col-xl-2 bd-toc">
        <ul id="table-of-content">
<li><a href="#toc-0">流图与会话</a><ul>
<li><a href="#toc-1">为什么要用数据流图？</a></li>
<li><a href="#toc-2"><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></a></li>
<li><a href="#toc-3"><a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code>tf.Graph</code></a></a></li>
<li><a href="#toc-4">操作的命名</a></li>
<li><a href="#toc-5">在不同设备部署操作</a></li>
<li><a href="#toc-6">可用作 Tensor 的对象</a></li>
<li><a href="#toc-7"><a href="https://www.tensorflow.org/api_docs/python/tf/Session"><code>tf.Session</code></a></a></li>
<li><a href="#toc-10">将流图可视化</a></li>
<li><a href="#toc-11">使用多个流图编程</a></li>
</ul>
</li>
</ul>

        </div>
    </div>
</div>
<!-- Content end-->

<!-- Footer start -->
<footer class="footer">
    <div class="container">
        <div>如果您发现本页面存在错误或可以改进，请<a href="https://github.com/xitu/tensorflow-docs/blob/zh-hans/programmers_guide/graphs.md" target="_blank">点击此处</a>帮助我们改进。本页贡献者：<span id="contributors"></span></div>
        <hr/>
        <div class="text-center official-links">
            <a href="https://www.tensorflow.org"><img
                    src="https://www.tensorflow.org/_static/b1fb9a8564/images/tensorflow/lockup.png" height="20"/></a>
            <a href="https://github.com/xitu/tensorflow-docs"><img
                    src="https://assets-cdn.github.com/images/modules/logos_page/GitHub-Logo.png" height="20"></a>
            <a href="https://juejin.im"><img src="//tensorflow.juejin.im/assets/imgs/logo_app_white.png" height="20"/></a>
        </div>
    </div>
</footer>
<script>
    var contributors = [{'leviding': 'https://avatars3.githubusercontent.com/u/26959437?v=4'}]
</script>
<!-- Footer end -->
</body>
<script src="//tensorflow.juejin.im/assets/js/jquery.slim.min.js" type="text/javascript"></script>
<script src="//tensorflow.juejin.im/assets/js/highlight.min.js" type="text/javascript"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script src="//tensorflow.juejin.im/assets/js/main.js" type="text/javascript"></script>
</html>