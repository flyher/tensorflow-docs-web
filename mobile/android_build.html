<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Building TensorFlow on Android</title>
    <link href="//xitu.github.io/tensorflow-docs-web/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="//xitu.github.io/tensorflow-docs-web/assets/css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
</head>
<body>
<!-- Header start -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">TensorFlow</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
        </ul>
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
    </div>
</nav>
<script>
    var head = [{'link': '//xitu.github.io/tensorflow-docs-web/extend/index.html', 'name': '扩展', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/install/index.html', 'name': '安装 TensorFlow', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/deploy/index.html', 'name': '部署', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/about/index.html', 'name': 'About TensorFlow', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/get_started/index.html', 'name': '开始', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/index.html', 'name': 'Overview', 'selected': 1}, {'link': '//xitu.github.io/tensorflow-docs-web/tutorials/index.html', 'name': '教程', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/performance/index.html', 'name': '性能', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/community/index.html', 'name': 'Community', 'selected': 0}, {'link': '//xitu.github.io/tensorflow-docs-web/programmers_guide/index.html', 'name': '开发者指南', 'selected': 0}]
</script>
<!-- Header end -->

<!-- Content start-->
<div class="container-fluid">
    <div class="row">
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
    <div class="sidebar-sticky" id="left-nav">

    </div>
</nav>
<script>
    var nav = [{'type': 'child', 'link': '//xitu.github.io/tensorflow-docs-web/mobile/index.html', 'title': 'Overview'}, {'type': 'parent', 'title': ' TensorFlow Lite', 'sub_class': [{'link': '//xitu.github.io/tensorflow-docs-web/mobile/tflite/index.html', 'title': 'TensorFlow Lite 简介'}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/tflite/demo_android.html', 'title': 'TensorFlow Lite Demo for Android'}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/tflite/demo_ios.html', 'title': 'TensorFlow Lite 演示（iOS）'}]}, {'type': 'parent', 'title': ' TensorFlow Mobile', 'sub_class': [{'link': '//xitu.github.io/tensorflow-docs-web/mobile/mobile_intro.html', 'title': 'TensorFlow Mobile 简介'}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/android_build.html', 'title': 'Building TensorFlow on Android'}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/ios_build.html', 'title': '在 iOS 中构建 TensorFlow'}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/linking_libs.html', 'title': '集成 TensorFlow 库'}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/prepare_models.html', 'title': 'Preparing models for mobile deployment'}, {'link': '//xitu.github.io/tensorflow-docs-web/mobile/optimizing.html', 'title': '移动端优化'}]}]
</script>
        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
            <h1>Building TensorFlow on Android</h1>
<p>To get you started working with TensorFlow on Android, we'll walk through two<br>
ways to build our TensorFlow mobile demos and deploying them on an Android<br>
device. The first is Android Studio, which lets you build and deploy in an<br>
IDE. The second is building with Bazel and deploying with ADB on the command<br>
line.</p>
<p>Why choose one or the other of these methods?</p>
<p>The simplest way to use TensorFlow on Android is to use Android Studio. If you<br>
aren't planning to customize your TensorFlow build at all, or if you want to use<br>
Android Studio's editor and other features to build an app and just want to add<br>
TensorFlow to it, we recommend using Android Studio.</p>
<p>If you are using custom ops, or have some other reason to build TensorFlow from<br>
scratch, scroll down and see our instructions<br>
for <a href="#build_the_demo_using_bazel">building the demo with Bazel</a>.</p>
<h2>Build the demo using Android Studio</h2>
<p><strong>Prerequisites</strong></p>
<p>If you haven't already, do the following two things:</p>
<ul>
<li><p>Install <a href="https://developer.android.com/studio/index.html">Android Studio</a>,<br>
following the instructions on their website.</p>
</li>
<li><p>Clone the TensorFlow repository from Github:</p>
<pre><code>  git clone https://github.com/tensorflow/tensorflow
</code></pre>
</li>
</ul>
<p><strong>Building</strong></p>
<ol>
<li><p>Open Android Studio, and from the Welcome screen, select <strong>Open an existing<br>
Android Studio project</strong>.</p>
</li>
<li><p>From the <strong>Open File or Project</strong> window that appears, navigate to and select<br>
 the <code>tensorflow/examples/android</code> directory from wherever you cloned the<br>
 TensorFlow Github repo.  Click OK.</p>
<p>If it asks you to do a Gradle Sync, click OK.</p>
<p>You may also need to install various platforms and tools, if you get<br>
 errors like "Failed to find target with hash string 'android-23' and similar.</p>
</li>
<li><p>Open the <code>build.gradle</code> file (you can go to <strong>1:Project</strong> in the side panel<br>
 and find it under the <strong>Gradle Scripts</strong> zippy under <strong>Android</strong>). Look for<br>
 the <code>nativeBuildSystem</code> variable and set it to <code>none</code> if it isn't already:</p>
<pre><code> // set to 'bazel', 'cmake', 'makefile', 'none'
 def nativeBuildSystem = 'none'
</code></pre>
</li>
<li><p>Click the Run button (the green arrow) or use <strong>Run -&gt; Run 'android'</strong> from the top menu.</p>
<p>If it asks you to use Instant Run, click <strong>Proceed Without Instant Run</strong>.</p>
<p>Also, you need to have an Android device plugged in with developer options<br>
 enabled at this<br>
 point. See <a href="https://developer.android.com/studio/run/device.html">here</a> for<br>
 more details on setting up developer devices.</p>
</li>
</ol>
<p>This installs three apps on your phone that are all part of the TensorFlow<br>
Demo. See <a href="#android_sample_apps">Android Sample Apps</a> for more information about<br>
them.</p>
<h2>Adding TensorFlow to your apps using Android Studio</h2>
<p>To add TensorFlow to your own apps on Android, the simplest way is to add the<br>
following lines to your Gradle build file:</p>
<pre><code>allprojects {
    repositories {
        jcenter()
    }
}

dependencies {
    compile 'org.tensorflow:tensorflow-android:+'
}
</code></pre>
<p>This automatically downloads the latest stable version of TensorFlow as an AAR<br>
and installs it in your project.</p>
<h2>Build the demo using Bazel</h2>
<p>Another way to use TensorFlow on Android is to build an APK<br>
using <a href="https://bazel.build/">Bazel</a> and load it onto your device<br>
using <a href="https://developer.android.com/studio/command-line/adb.html">ADB</a>. This<br>
requires some knowledge of build systems and Android developer tools, but we'll<br>
guide you through the basics here.</p>
<ul>
<li><p><a href="//xitu.github.io/tensorflow-docs-web/install/install_sources.html">通过源码安装 TensorFlow</a></p>
</li>
<li><p>Download the Android <a href="https://developer.android.com/studio/index.html">SDK</a><br>
and <a href="https://developer.android.com/ndk/downloads/index.html">NDK</a> if you do<br>
not already have them. You need at least version 12b of the NDK, and 23 of the<br>
SDK.</p>
</li>
<li><p>In your copy of the TensorFlow source, update the<br>
<a href="https://github.com/tensorflow/tensorflow/blob/master/WORKSPACE">WORKSPACE</a><br>
file with the location of your SDK and NDK, where it says &lt;PATH_TO_NDK&gt;<br>
and &lt;PATH_TO_SDK&gt;.</p>
</li>
<li><p>Run Bazel to build the demo APK:</p>
<pre><code>  bazel build -c opt //tensorflow/examples/android:tensorflow_demo
</code></pre>
</li>
<li><p>Use <a href="https://developer.android.com/studio/command-line/adb.html#move">ADB</a> to<br>
install the APK onto your device:</p>
<pre><code>  adb install -r bazel-bin/tensorflow/examples/android/tensorflow_demo.apk
</code></pre>
</li>
</ul>
<p>Note: In general when compiling for Android with Bazel you need<br>
<code>--config=android</code> on the Bazel command line, though in this case this<br>
particular example is Android-only, so you don't need it here.</p>
<p>This installs three apps on your phone that are all part of the TensorFlow<br>
Demo. See <a href="#android_sample_apps">Android Sample Apps</a> for more information about<br>
them.</p>
<h2>Android Sample Apps</h2>
<p>The<br>
<a href="https://www.tensorflow.org/code/tensorflow/examples/android/">Android example code</a> is<br>
a single project that builds and installs three sample apps which all use the<br>
same underlying code. The sample apps all take video input from a phone's<br>
camera:</p>
<ul>
<li><p><strong>TF Classify</strong> uses the Inception v3 model to label the objects it’s pointed<br>
at with classes from Imagenet. There are only 1,000 categories in Imagenet,<br>
which misses most everyday objects and includes many things you’re unlikely to<br>
encounter often in real life, so the results can often be quite amusing. For<br>
example there’s no ‘person’ category, so instead it will often guess things it<br>
does know that are often associated with pictures of people, like a seat belt<br>
or an oxygen mask. If you do want to customize this example to recognize<br>
objects you care about, you can use<br>
the<br>
<a href="https://codelabs.developers.google.com/codelabs/tensorflow-for-poets/index.html#0">TensorFlow for Poets codelab</a> as<br>
an example for how to train a model based on your own data.</p>
</li>
<li><p><strong>TF Detect</strong> uses a multibox model to try to draw bounding boxes around the<br>
locations of people in the camera. These boxes are annotated with the<br>
confidence for each detection result. Results will not be perfect, as this<br>
kind of object detection is still an active research topic.  The demo also<br>
includes optical tracking for when objects move between frames, which runs<br>
more frequently than the TensorFlow inference. This improves the user<br>
experience since the apparent frame rate is faster, but it also gives the<br>
ability to estimate which boxes refer to the same object between frames, which<br>
is important for counting objects over time.</p>
</li>
<li><p><strong>TF Stylize</strong> implements a real-time style transfer algorithm on the camera<br>
feed. You can select which styles to use and mix between them using the<br>
palette at the bottom of the screen, and also switch out the resolution of the<br>
processing to go higher or lower rez.</p>
</li>
</ul>
<p>When you build and install the demo, you'll see three app icons on your phone,<br>
one for each of the demos. Tapping on them should open up the app and let you<br>
explore what they do. You can enable profiling statistics on-screen by tapping<br>
the volume up button while they’re running.</p>
<h3>Android Inference Library</h3>
<p>Because Android apps need to be written in Java, and core TensorFlow is in C++,<br>
TensorFlow has a JNI library to interface between the two. Its interface is aimed<br>
only at inference, so it provides the ability to load a graph, set up inputs,<br>
and run the model to calculate particular outputs. You can see the full<br>
documentation for the minimal set of methods in<br>
<a href="https://www.tensorflow.org/code/tensorflow/contrib/android/java/org/tensorflow/contrib/android/TensorFlowInferenceInterface.java">TensorFlowInferenceInterface.java</a></p>
<p>The demos applications use this interface, so they’re a good place to look for<br>
example usage. You can download prebuilt binary jars<br>
at<br>
<a href="https://ci.tensorflow.org/view/Nightly/job/nightly-android/">ci.tensorflow.org</a>.</p>

        </main>
    </div>
</div>
<!-- Content end-->
</body>
<script src="//cdn.bootcss.com/jquery/3.3.1/jquery.slim.min.js" type="text/javascript"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js" type="text/javascript"></script>
<script src="//xitu.github.io/tensorflow-docs-web/assets/js/main.js" type="text/javascript"></script>
</html>